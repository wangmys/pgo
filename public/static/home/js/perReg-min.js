var gImgVerCdeErrorCount=0;var gImgVerCdeErrorCountMax=10;var grapGoOnMobile="";var offlineGoOnMobile="";var eppGoOnMobile="";var mobileAliasEPPValidObj={methodName:"mobileAliasEPP",elementId:"#mobileAlias",messageId:"#aliasTip",isEmptyHighlight:true};var imgCodeValidObj={methodName:"imgCode",elementId:"#imgCode",messageId:"#imgCodeTip",isEmptyHighlight:true,uidId:"#uid"};var smsCodeValidObj={methodName:"smsCode",elementId:"#smsCode",messageId:"#smsCodeTip",isEmptyHighlight:true,phoneNumId:"#mobileAlias",scen:"PERSON_MOBILE_REG_VERIFY_MOBILE"};var setPswValidObj={methodName:"setPsw",elementId:"#setPsw",messageId:"#setPswTip",isEmptyHighlight:true};var protocolValidObj={methodName:"protocol",elementId:"#protocol",messageId:"#protocolTip",isEmptyHighlight:true};function cleanInputStyle(a){if($(a).next(".ms-ico").size()>0){$(a).next(".ms-ico").remove()}$(a).parents(".error-border").removeClass("error-border")}function showInputSuccessStyle(a){if($(a).next(".ms-ico").size()>0){$(a).next(".ms-ico").remove()}if(!$(a).is("input[type=checkbox]")){$(a).after('<i class="ms-ico ms-ico-ok"></i>')}$(a).parents(".error-border").removeClass("error-border")}function showInputErrorStyle(a){if($(a).next(".ms-ico").size()>0){$(a).next(".ms-ico").remove()}if(!$(a).is("input[type=checkbox]")){$(a).after('<i class="ms-ico ms-ico-error"></i>')}$(a).parents(".reg-txtbox,.code-txtbox").addClass("error-border")}function showTipNormalStyle(a,b){$(a).html(b).removeClass("tip-error-color");if(a=="#setPswTip"){updateSetPswTipStyle()}if(a=="#smsCodeTip"){updateSmsCodeTipStyle()}}function showTipErrorStyle(a,b){$(a).html(b).addClass("tip-error-color");if(a=="#setPswTip"){updateSetPswTipStyle()}if(a=="#smsCodeTip"){updateSmsCodeTipStyle()}}function updateSetPswTipStyle(){var a=$("#setPswTip").html();if(a!=undefined&&a!=null&&a!=""){$("#setPswTip").show();return}if($(".safe-rank-box:visible").size()>0){$("#setPswTip").hide()}else{$("#setPswTip").show()}}function updateSmsCodeTipStyle(){$("#yyTip").css("padding-top","5px");var a=$("#smsCodeTip").html();if(a!=undefined&&a!=null&&a!=""){$("#smsCodeTip").show();if($("#yyTip:visible").size()>0){$("#yyTip").css("padding-top","0")}return}if($("#yyTip:visible").size()>0){$("#smsCodeTip").hide()}else{$("#smsCodeTip").show()}}function checkPwdSafeLevel(){var b=$("#setPsw").val();var c=$("#setPsw_rank");if(b.length>=6){var a=checkPasswordStrength(b);if("A"==a){c.removeClass().addClass("safe-rank strengthA")}if("B"==a){c.removeClass().addClass("safe-rank strengthB")}if("C"==a){c.removeClass().addClass("safe-rank strengthC")}}else{c.removeClass().addClass("safe-rank")}}function showErrorBox(b,a){if(!a){$("#step"+b+" .error-box").addClass("hide");$("#step"+b+" .error-box span").html("");return}$("#step"+b+" .error-box").removeClass("hide");$("#step"+b+" .error-box span").html(a)}var setPswSugTip='6-20个字符，由字母、数字和符号的两种以上组合。<a href="javascript:account.winAct({isOpen:true,isIframe:true,id:\'setPassword\'});" tabindex="-1" id="pswSuggestion" name="Preg_index_none_password">密码设置建议</a>';var smsCodeTip="";var voiceCodeEable=false;var srsSmsSeqNum=0;$(function(){srscommon.ajaxRegchannel(function(a){$("#accountCreatedChannel").val(a)});srsval.init({baseurl:$("#baseUrl").val(),highlight:function(f,e,g,d){var b=f.elementId;var c=f.messageId;var a=f.isEmptyHighlight;if(!a&&g=="__empty"){if($(c).hasClass("tip-error-color")){showTipNormalStyle(c,"")}cleanInputStyle(b);return}switch(b){case"#mobileAlias":if(g=="cmf_cangrap"){account.winAct({isOpen:true,isIframe:true,id:"cangrap-confirm"});showTipNormalStyle("#aliasTip","");cleanInputStyle("#mobileAlias");return}if(g=="cmf_offline"){account.winAct({isOpen:true,isIframe:true,id:"offline-confirm"});showTipNormalStyle("#aliasTip","");cleanInputStyle("#mobileAlias");return}if(g=="E001_EPPAlaisExit"){account.winAct({isOpen:true,isIframe:true,id:"epp-mobile-confirm"});showTipNormalStyle("#aliasTip","");cleanInputStyle("#mobileAlias");return}break;case"#imgCode":gImgVerCdeErrorCount++;if(gImgVerCdeErrorCount>=gImgVerCdeErrorCountMax){gImgVerCdeErrorCount=0;srscommon.fun_getVcode("#imgSrc","#uid");$("#imgCode").val("")}break}showInputErrorStyle(b);switch(b){case"#smsCode":if(g=="1103"){showErrorBox(1,d);showTipNormalStyle("#smsCodeTip","");cleanInputStyle("#smsCode");$("#smsCode").val("");return}}showTipErrorStyle(c,d)},unhighlight:function(e,d,f,c){var a=e.elementId;var b=e.messageId;switch(a){}showTipNormalStyle(b,"");showInputSuccessStyle(a)}});srscommon.checkRegTypeAndImgShow(function(a){},function(a){},function(a){$(".imgCodeDiv").show();srscommon.fun_getVcode("#imgSrc","#uid");$("#imgCode").addClass("isnull")},function(a){$(".imgCodeDiv").hide();$("#uid").val("");$("#mobileAlias").addClass("isnull")},function(){voiceCodeEable=true},function(){voiceCodeEable=false});$(".isnull").on("keyup blur",function(){if($(this).val()==null||$(this).val()==""){$(".issetgray").addClass("setgray");$(".issetgray .shadow").show()}else{$(".issetgray").removeClass("setgray");$(".issetgray .shadow").hide()}});$(".isnull").trigger("blur");$("#imgSrc,#changeImgSrc").click(function(){srscommon.fun_getVcode("#imgSrc","#uid");$("#imgCode").val("");cleanInputStyle("#imgCode");showTipNormalStyle("#imgCodeTip","")});$("#mobileAlias").focus(function(){showTipNormalStyle("#aliasTip","");cleanInputStyle("#mobileAlias")}).blur(function(){srsval.valid({validObjs:[$.extend({},mobileAliasEPPValidObj,{grapGoOnMobile:grapGoOnMobile,isAjaxCheck:false,isEmptyHighlight:false})]})}).keyup(function(a){if(a.which==13&&$("#step1save").css("display")!="none"){$("#step1save").trigger("click");return}});$("#imgCode").focus(function(){showTipNormalStyle("#imgCodeTip","");cleanInputStyle("#imgCode")}).blur(function(){var a=$(this).val();if(a.length!=4){srsval.valid({validObjs:[$.extend({},imgCodeValidObj,{isAjaxCheck:false,isEmptyHighlight:false})]})}}).keyup(function(b){if(b.which==13&&$("#step1save").css("display")!="none"){$("#step1save").trigger("click");return}var a=$(this).val();if(a.length==4){srsval.valid({validObjs:[$.extend({},imgCodeValidObj,{isAjaxCheck:true,isEmptyHighlight:false})]})}});$("#smsCode").focus(function(){showTipNormalStyle("#smsCodeTip",smsCodeTip);cleanInputStyle("#smsCode")}).blur(function(){var a=$(this).val();if(a==""){showTipNormalStyle("#smsCodeTip","")}if(a.length!=6){srsval.valid({validObjs:[$.extend({},smsCodeValidObj,{isAjaxCheck:false,isEmptyHighlight:false})]})}}).keyup(function(a){if(a.which==13&&$("#step2save").css("display")!="none"){$("#step2save").trigger("click");return}var b=$(this).val();if(b.length==6){srsval.valid({validObjs:[$.extend({},smsCodeValidObj,{isAjaxCheck:true,isEmptyHighlight:false})]})}});srscommon.bindSmsSendButton({sendButtonId:"#sendSmsCode",sendButtonDisableClass:"noActive",sendButtonEnableClass:"void-clazz",secondNum:60,vaildateDataFun:function(){if(!srsval.valid({validObjs:[$.extend({},mobileAliasEPPValidObj,{isAjaxCheck:false})]})){return false}if($("#uid").val().length>0){if(!srsval.valid({validObjs:[imgCodeValidObj]})){return false}}return true},getSendAjaxDataFun:function(){return{scen:"PERSON_MOBILE_REG_VERIFY_MOBILE",phoneNum:$("#mobileAlias").val(),uid:$("#uid").val(),code:$("#imgCode").val()}},sendCodeCallback:function(a,b,d,c){if("R0000"==a){srsSmsSeqNum=d;$("#mseqNum").val(d);cleanInputStyle("#smsCode");showTipNormalStyle("#smsCodeTip","短信验证码第<em>"+d+"</em>次发送，8小时内有效！");smsCodeTip="请输入序号为<em>"+d+"</em>的验证码"}else{if(null!=b&&""!=b){showTipNormalStyle("#smsCodeTip",b)}else{showTipNormalStyle("#smsCodeTip","发送失败")}}},secCountCallback:function(a){if(!voiceCodeEable){return}if(a==0&&srsSmsSeqNum==1){$("#yyTip").show();updateSmsCodeTipStyle()}else{if(a==0&&srsSmsSeqNum>=2){$("#yyTip").hide();updateSmsCodeTipStyle()}}}});srscommon.bindYuyiSendButton({sendButtonId:"#sendYy",sendButtonDisableClass:"noActive",sendButtonEnableClass:"void-clazz",vaildateDataFun:function(){if(!srsval.valid({validObjs:[$.extend({},mobileAliasEPPValidObj,{isAjaxCheck:false})]})){return false}if($("#uid").val().length>0){if(!srsval.valid({validObjs:[imgCodeValidObj]})){return false}}return true},getSendAjaxDataFun:function(){return{scen:"PERSON_MOBILE_REG_VERIFY_VOICE",phoneNum:$("#mobileAlias").val(),uid:$("#uid").val(),code:$("#imgCode").val()}},sendCodeCallback:function(a,b,d,c){if("R0000"==a){account.winAct({isOpen:true,isIframe:true,id:"yuyin"});$(".yuyin-yyMsg").html("稍后将有苏宁的电话拨打给您，告知验证码内容，请耐心等待~");$("#sendYy").hide();$("#sendYying").show()}else{if(null!=b&&""!=b){account.winAct({isOpen:true,isIframe:true,id:"yuyin"});$(".yuyin-yyMsg").html(b)}else{account.winAct({isOpen:true,isIframe:true,id:"yuyin"});$(".yuyin-yyMsg").html("语音验证码发送失败")}$("#sendYy").show();$("#sendYying").hide()}}});$("#protocol").click(function(){srsval.valid({validObjs:[protocolValidObj]})});$(".cangrap-confirm-login-btn").live("click",function(){logonUrl("","",$("#mobileAlias").val())});$(".cangrap-confirm-continue-btn").live("click",function(){grapGoOnMobile=$("#mobileAlias").val();account.winAct({isOpen:false,isIframe:false,id:"cangrap-confirm"});$("#step1save").trigger("click")});$(".offline-confirm-continue-btn").live("click",function(){offlineGoOnMobile=$("#mobileAlias").val();account.winAct({isOpen:false,isIframe:false,id:"offline-confirm"});$("#step1save").trigger("click")});$(".epp-mobile-confirm-continue-btn").live("click",function(){eppGoOnMobile=$("#mobileAlias").val();account.winAct({isOpen:false,isIframe:false,id:"epp-mobile-confirm"});$("#step1save").trigger("click")});$(".epp-mobile-confirm-login-btn").live("click",function(){srscommon.eppLogin()});$("#step1save").click(function(){$("#step1save").hide();$("#step1saveing").show();var a=$.extend({},mobileAliasEPPValidObj,{isAjaxCheck:false});if(!srsval.valid({validObjs:[a,imgCodeValidObj,smsCodeValidObj,protocolValidObj]})){$("#step1save").show();$("#step1saveing").hide();return}a=$.extend({},mobileAliasEPPValidObj,{grapGoOnMobile:grapGoOnMobile,offlineGoOnMobile:offlineGoOnMobile,eppGoOnMobile:eppGoOnMobile});if(!srsval.valid({validObjs:[a]})){$("#step1save").show();$("#step1saveing").hide();return}showErrorBox(1,"");$(".tab-cont").hide();$("#step2").show()});$("#setPsw").focus(function(){showTipNormalStyle("#setPswTip",setPswSugTip);cleanInputStyle("#setPsw")}).blur(function(){if($("#setPsw").data("canntBlur")){return}showTipNormalStyle("#setPswTip","");srsval.valid({validObjs:[$.extend({},setPswValidObj,{isEmptyHighlight:false})]})}).keyup(function(a){if(a.which==13&&$("#step2save").css("display")!="none"){$("#step2save").trigger("click");return}if($("#setPsw").val().length>=6){$(".safe-rank-box").show();checkPwdSafeLevel();updateSetPswTipStyle()}else{$(".safe-rank-box").hide();updateSetPswTipStyle()}});$("#pswSuggestion").live("mouseover",function(){$("#setPsw").data("canntBlur",true)}).live("mouseout",function(){$("#setPsw").data("canntBlur",false)});srscommon.bindKeypressCapsLock("setPsw",function(){showTipNormalStyle("#setPswTip","键盘大写锁定已打开，请注意大小写 ")},function(){showTipNormalStyle("#setPswTip",setPswSugTip)});$("#step2save").click(function(){$("#step2save").hide();$("#step2saveing").show();if(!srsval.valid({validObjs:[setPswValidObj]})){$("#step2save").show();$("#step2saveing").hide();return}$("#enterReg_form").submit()})});