var st=st||{};st.tooltipNew={run:function(options){var config={selector:"",style:null,type:"click",placement:"top",selector:null,container:"body",template:'<div class="ui-tooltip"><div class="ui-tooltip-arrow"><i class="ui-tooltip-arrow-front">◆</i><i class="ui-tooltip-arrow-back">◆</i></div><div class="ui-tooltip-inner">tooltip</div></div>',html:"",node:"",wrapper:"",flag:"",openFn:function(tipDom,targeDom,tipFn){},closeFn:function(tipDom,targeDom,tipFn){}};options=$.extend(config,options);this.fnList.push({selectorName:options.selector,openFn:options.openFn,closeFn:options.closeFn});this.listen(options)},resizeIaAlreadyRun:0,clickIsAlreadyRun:0,listen:function(options){var _this=this;if(options.type=="click"){$(document).on(options.type,options.selector,function(event){event&&event.preventDefault();event&&event.stopPropagation();var thisData=$(this).data();if(typeof thisData.tipForce!=undefined&&thisData.tipForce&&thisData.tipForce==1){return}if(typeof thisData.tipShow!=undefined&&thisData.tipShow&&thisData.tipShow==1){$(this).data("tipShow",0);_this.allHide()}else{_this.allHide();var targetNum=new Date().getTime();$(this).data({tipNum:targetNum,tipShow:1});_this.getHtml(options,$(this))}});if(_this.clickIsAlreadyRun==0){_this.clickIsAlreadyRun=1;$(document).on(options.type,function(event){if($(event.target).closest(".ui-tooltip").size()!=0){return}_this.allHide()})}}else{if(options.type=="hover"){var enter="mouseenter";var leave="mouseleave";$(document).on(enter,options.selector,function(event){_this.allHide();var targetNum=new Date().getTime();$(this).data({tipNum:targetNum});_this.getHtml(options,$(this))});$(document).on(leave,options.selector,function(event){_this.allHide()})}}if(_this.resizeIaAlreadyRun==0){_this.resizeIaAlreadyRun=1;$(window).resize(function(){_this.allHide()})}},getHtml:function(options,target){var tipDom=$(options.template);var innerHtml=tipDom.find(".ui-tooltip-inner");var opHtml=options.html;var opNode=options.node;var opFlag=options.flag;var closeBtn=options.closeBtn;var targetData=target.data();var targetDataHtml=targetData.html;var targetDataNode=targetData.node;var targetDataFlag=targetData.flag;var trueHtml;if(typeof opHtml!="undefined"&&opHtml){trueHtml=opHtml}else{if(typeof opNode!="undefined"&&opNode){trueHtml=$(opNode).clone().html()}}if(typeof targetDataHtml!="undefined"&&targetDataHtml){trueHtml=targetDataHtml}else{if(typeof targetDataNode!="undefined"&&targetDataNode){trueHtml=$(targetDataNode).clone().html()}}innerHtml.html(trueHtml);if(typeof closeBtn!="undefined"&&closeBtn){tipDom.prepend('<div class="ui-tooltip-close" onclick="st.tooltipNew.allHide();">×</div>')}tipDom.attr({"data-tip-targetnum":targetData.tipNum,"data-tip-targetselectorname":options.selector});if(typeof targetDataFlag!="undefined"&&targetDataFlag){tipDom.addClass(targetDataFlag)}else{if(typeof opFlag!="undefined"&&opFlag){tipDom.addClass(opFlag)}}var trueWrapper=this.getWrapper(options,target);trueWrapper.append(tipDom);trueWrapper=null;this.getSelectorFn(options.selector).openFn(options,tipDom,target,this);this.position(options,tipDom,target)},getWrapper:function(options,target){var opWrapper=options.wrapper;var targetData=target.data();var targetDataWrapper=targetData.wrapper;var trueWrapper;if(typeof opWrapper!="undefined"&&opWrapper){if(opWrapper.indexOf("#")){trueWrapper=$(opWrapper)}else{trueWrapper=target.closest(opWrapper)}}else{if(typeof targetDataWrapper!="undefined"&&targetDataWrapper){if(targetDataWrapper.indexOf("#")){trueWrapper=$(targetDataWrapper)}else{trueWrapper=target.closest(targetDataWrapper)}}else{trueWrapper=$("body")}}return trueWrapper},position:function(options,tipDom,target){var targetData=target.data();var targetStyle=options.style;var targetPlacement=options.placement;if(typeof targetData.style!="undefined"&&targetData.style&&targetData.style!="undefined"){try{var transformSymbol=targetData.style.replace(/&apos;/g,"'");targetStyle=$.extend({display:"block"},eval("("+transformSymbol+")"))}catch(e){}}if(typeof targetData.placement!="undefined"&&targetData.placement&&targetData.placement!="undefined"){targetPlacement=targetData.placement}if(typeof targetStyle==="object"&&targetStyle){tipDom.css(targetStyle)}tipDom.addClass("ui-tooltip-"+targetPlacement);var targetOffSet=target.offset();var targetH=target.outerHeight();var targetW=target.outerWidth();var tipW=tipDom.outerWidth();var tipH=tipDom.outerHeight();var wrapper=this.getWrapper(options,target);var position=wrapper.css("position")=="absolute"||wrapper.css("position")=="relative";var wrapperLeft=position?wrapper.offset().left:0;var wrapperTop=position?wrapper.offset().top:0;switch(targetPlacement){case"right":tipDom.css({top:targetOffSet.top-tipH/2+targetH/2-wrapperTop,left:targetOffSet.left+targetW+8-wrapperLeft});break;case"bottom":tipDom.css({top:targetOffSet.top+targetH+8-wrapperTop,left:targetOffSet.left-tipW/2+targetW/2-wrapperLeft});break;case"left":tipDom.css({top:targetOffSet.top-tipH/2+targetH/2-wrapperTop,left:targetOffSet.left-tipW-8-wrapperLeft});break;default:tipDom.css({top:targetOffSet.top-tipH-8-wrapperTop,left:targetOffSet.left-tipW/2+targetW/2-wrapperLeft});break}wrapper=null},allHide:function(clearAll){var _this=this;var clearAll=clearAll||0;var dUiTooltipNew=$(".ui-tooltip");if(dUiTooltipNew.length<=0){dUiTooltipNew=null;return}var isForce=0;dUiTooltipNew.each(function(){var tipDom=this;var targetNum=$(this).attr("data-tip-targetnum");var targetSelectorName=$(this).attr("data-tip-targetselectorname");$(targetSelectorName).each(function(){if($(this).data("tipNum")==targetNum){var newForce=$(this).data("tipForce");if(typeof newForce!="undefined"&&newForce&&newForce==1&&clearAll==0){isForce=newForce;return}$(this).removeData("tipNum");$(this).removeData("tipShow");_this.getSelectorFn(targetSelectorName).closeFn($(tipDom),$(this),_this);return}});if(isForce==0||clearAll==1){$(this).remove()}});dUiTooltipNew=null},oneHide:function(nowTargetNum){var _this=this;var nowTargetNum=nowTargetNum||"";var dUiTooltipNew=$(".ui-tooltip");if(dUiTooltipNew.length<=0){dUiTooltipNew=null;return}dUiTooltipNew.each(function(){var tipDom=this;var targetNum=$(this).attr("data-tip-targetnum");var targetSelectorName=$(this).attr("data-tip-targetselectorname");if(targetNum==nowTargetNum){$(targetSelectorName).each(function(){if($(this).data("tipNum")==targetNum){$(this).removeData("tipNum");$(this).removeData("tipShow");$(this).removeData("tipForce");_this.getSelectorFn(targetSelectorName).closeFn($(tipDom),$(this),_this);return}});$(this).remove();return}});dUiTooltipNew=null},getSelectorFn:function(selectorName){var _this=this;var fn;for(var i=0,listLen=_this.fnList.length;i<listLen;i++){if(_this.fnList[i].selectorName==selectorName){fn=_this.fnList[i];break}}return fn},fnList:[],clearClickState:function(){$(".tip-click-mark").each(function(){$(this).removeData("tipNum");$(this).removeData("tipShow")})}};